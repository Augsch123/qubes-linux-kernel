From: Kyle McMartin <kyle@dreadnought.i.jkkm.org>
Subject: flexcop: fix registering braindead stupid names
References: brc#575873 bnc#661429
Patch-mainline: Unsubmitted by author

 This patch fixes an issue where the flexcop driver passes DRIVER_NAME to
 request_irq, which ultimately sets up proc files. The invalid name
 contains slashes so the proc file creation fails and we get a WARN_ON.

Acked-by: Jeff Mahoney <jeffm@suse.com>
---

 drivers/media/dvb/b2c2/flexcop-pci.c |    5 +++--
 1 file changed, 3 insertions(+), 2 deletions(-)

--- a/drivers/media/dvb/b2c2/flexcop-pci.c
+++ b/drivers/media/dvb/b2c2/flexcop-pci.c
@@ -39,6 +39,7 @@ MODULE_PARM_DESC(debug,
 
 #define DRIVER_VERSION "0.1"
 #define DRIVER_NAME "Technisat/B2C2 FlexCop II/IIb/III Digital TV PCI Driver"
+#define FLEXCOP_MODULE_NAME "b2c2-flexcop"
 #define DRIVER_AUTHOR "Patrick Boettcher <patrick.boettcher@desy.de>"
 
 struct flexcop_pci {
@@ -299,7 +300,7 @@ static int flexcop_pci_init(struct flexc
 		return ret;
 	pci_set_master(fc_pci->pdev);
 
-	if ((ret = pci_request_regions(fc_pci->pdev, DRIVER_NAME)) != 0)
+	if ((ret = pci_request_regions(fc_pci->pdev, FLEXCOP_MODULE_NAME)) != 0)
 		goto err_pci_disable_device;
 
 	fc_pci->io_mem = pci_iomap(fc_pci->pdev, 0, 0x800);
@@ -313,7 +314,7 @@ static int flexcop_pci_init(struct flexc
 	pci_set_drvdata(fc_pci->pdev, fc_pci);
 	spin_lock_init(&fc_pci->irq_lock);
 	if ((ret = request_irq(fc_pci->pdev->irq, flexcop_pci_isr,
-					IRQF_SHARED, DRIVER_NAME, fc_pci)) != 0)
+					IRQF_SHARED, FLEXCOP_MODULE_NAME, fc_pci)) != 0)
 		goto err_pci_iounmap;
 
 	fc_pci->init_state |= FC_PCI_INIT;
